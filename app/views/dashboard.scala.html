@(jobs: Iterable[(JobConfiguration, JobData)] = None, user: User)(implicit flash: Flash)

@import org.w3.vs.actor._

@libs.main("Validator Suite", 
  stylesheets = List("dashboard.css"),
      scripts = List("model.js", "vs.js", "dashboard.js")){
   
   @***** Header ******@
   
	@libs.header(Some(user))
	
}{ @***** Toolbar *****@
	
}{ @***** Content *****@ 
	
	<nav>
		<a href="@routes.Jobs.new1">New job</a>
	</nav>
	
	@libs.messages()
	
	<section id="jobs" class="list">
		
		<header>
			<div class="name">Name</div>
			<div class="url">URL</div>
			<div class="date">Date</div>
			<div class="resources">Resources</div>
			<div class="errors">Errors</div>
			<div class="warnings">Warnings</div>
			<div class="health">Health</div>
			<div class="status">Status</div>
		</header>
		
		@for((jobConf, data) <- jobs) {
		<article data-id="@jobConf.id">
			<div class="name">@jobConf.name</div>
			<div class="url">@jobConf.strategy.seedURLs.head</div>
			<div class="date"><time datetime="">-</time></div>
			<div class="resources">@data.resources</div>
			<div class="errors">@data.errors</div>
			<div class="warnings">@data.warnings</div>
			<div class="health">Health</div>
			<div>
				<span class="status">@data.activity</span>
				<form action="@routes.Jobs.dispatcher(jobConf.id)" method="post">
					@defining(data.activity) { activity =>
					@activity match {
					  case Busy => {<button type="submit" name="action" value="stop" class="stop">Cancel</button>}
					  case Idle => {<button type="submit" name="action" value="refresh" class="refresh">Run Now</button>}
					}}
				</form>
			</div>
			<!-- <form action="@routes.Jobs.dispatcher(jobConf.id)" method="post">
				<button type="submit" class="show" formmethod="get">Show</button>
				@defining(data.explorationMode) { mode =>
				@defining(data.activity) { activity =>
				  @activity match {
				    case Busy => {<button type="submit" name="action" value="stop" class="stop">Stop</button>}
				    case Idle => {
				      @mode match {
				        case ProActive => {<button type="submit" name="action" value="off" class="off">Off</button>}
				        case      Lazy => {<button type="submit" name="action" value="on" class="on">On</button>}
				      }
				    }
				  }
				}}
				<button type="submit" name="action" value="refresh" class="refresh">Refresh</button>
				<button type="submit" class="edit" formmethod="get" formaction="routes.Jobs.edit(jobConf.id)">Edit</button>
				<button type="submit" name="action" value="delete" class="delete">Delete</button>
			</form> -->
		</article>
		}
	</section>
	
}{ @***** Footer *****@

	<script type="text/template" id="job-template">
			<div class="name"><%= name %></div>
			<div class="url"><%= seedUri %></div>
			<div class="date"><time datetime="">-</time></div>
			<div class="resources"><%= data.get('resources') %></div>
			<div class="errors"><%= data.get('errors') %></div>
			<div class="warnings"><%= data.get('warnings') %></div>
			<div class="health">Health</div>
			<div>
				<span class="status"><%= data.get('activity') %></span>
				<% switch(data.get('activity')) { 
				case "Busy": %>
					<a class="stop" href="">Cancel</a>
				<% break; case "Idle": %>
					<a class="refresh" href="">Run Now</a>
				<% } %>
			</div>
	</script>

	@libs.footer()

}
