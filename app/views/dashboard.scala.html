@(jobs: Iterable[(JobConfiguration, JobData)] = None, user: User)(implicit flash: Flash)

@import org.w3.vs.actor._

@libs.main("Validator Suite", 
  stylesheets = List("dashboard.css"),
      scripts = List("model.js", "vs.js", "dashboard.js")){
   
   @***** Header ******@
   
	@libs.header(Some(user))
	
}{ @***** Toolbar *****@
	
}{ @***** Content *****@ 
	
	<nav>
		<a href="@routes.Jobs.new1">New job</a>
	</nav>
	
	@libs.messages()
	
	<section id="jobs" class="list">
		
		<header>
			<div class="name">Name</div>
			<div class="url">URL</div>
			<div class="date">Date</div>
			<div class="resources">Resources</div>
			<div class="errors">Errors</div>
			<div class="warnings">Warnings</div>
			@**<div class="health">Health</div>**@
			<div class="status">Status</div>
		</header>
		
		@for((jobConf, data) <- jobs) {
		<article data-id="@jobConf.id">
			<div class="name"><a href="@routes.Jobs.dispatcher(jobConf.id)">@jobConf.name</a></div>
			<div class="url">@jobConf.strategy.seedURLs.head</div>
			<div class="date"><time datetime="">03/12/12 at 2:55pm</time></div>
			<div class="resources">@data.resources</div>
			<div class="errors">@data.errors</div>
			<div class="warnings">@data.warnings</div>
			@**<div class="health"></div>**@
			<div>
				<span class="status">@data.activity</span>
				<form action="@routes.Jobs.dispatcher(jobConf.id)" method="post">
					@defining(data.activity) { activity =>
					@activity match {
					  case Busy => {<button type="submit" name="action" value="stop" class="stop">Cancel</button>}
					  case Idle => {<button type="submit" name="action" value="refresh" class="refresh">Run Now</button>}
					}}
				</form>
			</div>
		</article>
		}
	</section>
	
}{ @***** Footer *****@

	<script type="text/template" id="job-template">
			<div class="name"><a href=<%= url %>><%= name %></a></div>
			<div class="url"><%= seedUri %></div>
			<div class="date"><time datetime="">03/12/12 at 2:55pm</time></div>
			<div class="resources"><%= data.get('resources') %></div>
			<div class="errors"><%= data.get('errors') %></div>
			<div class="warnings"><%= data.get('warnings') %></div>
			@**<div class="health"></div>**@
			<div>
				<span class="status"><%= data.get('activity') %></span>
				<% switch(data.get('activity')) { 
				case "Busy": %>
					<a class="stop" href="<%= url + '/stop' %>">Cancel</a>
				<% break; case "Idle": %>
					<a class="refresh" href="<%= url + '/refresh' %>">Run Now</a>
				<% } %>
			</div>
	</script>

	@libs.footer()

}
