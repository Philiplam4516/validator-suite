@(jobConf: JobConfiguration, 
    data: JobData,
    report: List[(String, org.w3.vs.view.ReportListAside, List[(String, org.w3.vs.view.ReportListAside, List[(String, org.w3.vs.view.ReportListAside, List[String])] )] )],
    user: User,
    errors: List[(String, String)] = List.empty)(implicit flash: Flash)

@import org.w3.vs.view._

@libs.main("Validator Suite", 
	stylesheets = List("dashboard.css"),
   scripts = List("model.js", "vs.js", "report.js")){
   
   @***** Header ******@
	
	@libs.header(Some(user))
	
}{ @***** Toolbar *****@

	<ul>
		<li><a href="">Default</a></li>
		<li><a href="?valid">Valid resources</a></li>
		<li><a href="?type=error">Only show errors</a></li>
		<li><a href="?assertor=ValidatorNu">Validator.nu results</a></li>
		<li><a href="?assertor=CSSValidator">CSS validator results</a></li>
		<li><a href="?sort=errors">Sort per errors</a></li>
		<li><a href="?sort=warnings">Sort per warnings</a></li>
		<li><a href="?sort=urls">Sort per url</a></li>
		<li><a href="?group=message.context">Group by message then context</a></li>
		<li><a href="?group=message.url">Group by message then url</a></li>
		<li><a href="?group=url.assertor">Group by url then assertor (default)</a></li>
	</ul>

}{ @***** Content *****@ 
	
	@libs.navigation(List((jobConf.name ,"")))
	@libs.messages(errors)
	
	<section class="job" data-id="@jobConf.id"><div>
		<ul>
			<li>Name: <span class="name">@jobConf.name</span></li>
			<li>Uri: <span class="uri">@jobConf.strategy.seedURLs.head</span></li>
			<li>Distance: <span class="distance">@jobConf.strategy.distance</span></li>
			<li>Activity: <span class="activity">@data.activity</span></li>
			<li>Explo mode: <span class="mode">@data.explorationMode</span></li>
		</ul>
		<ul>
			<!-- <li>Last run: <time datetime="">-</time></li> -->
			<li>Last updated: <time datetime="">-</time></li>
			<li>Resources: <span class="resources">@data.resources</span></li>
			<li>Valid: <span class="oks">@data.oks</span></li>
			<li>Errors: <span class="errors">@data.errors</span></li>
			<li>Warnings: <span class="warnings">@data.warnings</span></li>
		</ul>
		<form action="@routes.Jobs.dispatcher(jobConf.id)" method="post">
			<button type="submit" class="show" formmethod="get">Show</button>
			@defining(data.explorationMode) { mode =>
			@defining(data.activity) { activity =>
			  @activity match {
			    case Busy => {<button type="submit" name="action" value="stop" class="stop">Stop</button>}
			    case Idle => {
			      @mode match {
			        case ProActive => {<button type="submit" name="action" value="off" class="off">Off</button>}
			        case      Lazy => {<button type="submit" name="action" value="on" class="on">On</button>}
			      }
			    }
			  }
			}}
			<button type="submit" name="action" value="refresh" class="refresh">Refresh</button>
			<button type="submit" class="edit" formmethod="get" formaction="@routes.Jobs.edit(jobConf.id)">Edit</button>
			<button type="submit" name="action" value="delete" class="delete">Delete</button>
		</form>
	</div></section>
	
	<section id="report" class="list">
	
	@report.map { case (title, aside, sub) =>
	@defining(java.util.UUID.randomUUID.toString.substring(0,6)) {id =>
	<article id="@id" tabindex="1">
	<div>
		<a href="#@id">@title</a>
		@aside.toString
	</div>
	<div>
	   @sub.map { case (title, aside, sub) =>
		<article tabindex="1">
		<div>
			<span>@title</span>
			@aside.toString
		</div>
		<div>
			@sub.map { case (title, aside, sub) =>
			<article tabindex="1">
			<div>
				<span>@title</span>
				@aside.toString
			</div>
			<div>
		      @sub.map { case (text) =>
		      	@text
		      }
	      </div>
	      </article>
			}
		</div>
		</article>
		}
	</div>
	</article>
	}}
	

	

	</section>
	
}{ @***** Footer *****@

	@libs.footer()

}
