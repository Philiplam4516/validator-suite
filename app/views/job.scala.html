@(jobConf: JobConfiguration, data: JobData, assertionsResults: Iterable[AssertorResult], user: User, errors: List[(String, String)] = List())(implicit flash: Flash)

@libs.main("Validator Suite", 
	stylesheets = List("dashboard.css"),
   scripts = List("model.js", "vs.js", "report.js")){
   
   @***** Header ******@
	
	@libs.header(Some(user))
	
}{ @***** Toolbar *****@

	<!-- <ul><li><a href="@routes.Dashboard.dashboard">Dashboard</a></li></ul> -->
	
}{ @***** Content *****@ 
	
	@libs.navigation()
	@libs.errors(errors)
	
	<section class="job" data-id="@jobConf.id"><div>
		<ul>
			<li>Name: <span class="name">@jobConf.name</span></li>
			<li>Uri: <span class="uri">@jobConf.strategy.seedURLs.head</span></li>
			<li>Distance: <span class="distance">@jobConf.strategy.distance</span></li>
			<li>Activity: <span class="activity">@data.activity</span></li>
			<li>Explo mode: <span class="mode">@data.explorationMode</span></li>
		</ul>
		<ul>
			<!-- <li>Last run: <time datetime="">-</time></li> -->
			<li>Last updated: <time datetime="">-</time></li>
			<li>Resources: <span class="resources">@data.resources</span></li>
			<li>Valid: <span class="oks">@data.oks</span></li>
			<li>Errors: <span class="errors">@data.errors</span></li>
			<li>Warnings: <span class="warnings">@data.warnings</span></li>
		</ul>
		<form action="@routes.Dashboard.jobDispatcher(jobConf.id)" method="post">
			<button type="submit" class="show" formmethod="get">Show</button>
			@defining(data.explorationMode) { mode =>
			@defining(data.activity) { activity =>
			  @activity match {
			    case Busy => {<button type="submit" name="action" value="stop" class="stop">Stop</button>}
			    case Idle => {
			      @mode match {
			        case ProActive => {<button type="submit" name="action" value="off" class="off">Off</button>}
			        case      Lazy => {<button type="submit" name="action" value="on" class="on">On</button>}
			      }
			    }
			  }
			}}
			<button type="submit" name="action" value="refresh" class="refresh">Refresh</button>
			<button type="submit" class="edit" formmethod="get" formaction="@routes.Dashboard.editJob(jobConf.id)">Edit</button>
			<button type="submit" name="action" value="delete" class="delete">Delete</button>
		</form>
	</div></section>
	
	<section id="report" class="list">
	
	
	@assertionsResults.collect{case sertion: Assertions if (!sertion.isValid) =>
	
	<article id="@{sertion.id.toString.substring(0,6)}" tabindex="1">
		<div>
			<a class="resource" href="#@{sertion.id.toString.substring(0,6)}">@sertion.url</a>
			<ul class="meta">
				<li class="assertor">@sertion.assertorId</li>
				<li class="errors">@sertion.numberOfErrors</li>
				<li class="warnings">@sertion.numberOfWarnings</li>
				<!-- <li>Timestamp: @sertion.timestamp</li> -->
			</ul>
		</div>
		<div>
			<ul class="messages">
			@defining(sertion.assertions) { raws =>
			@raws.map { raw =>
			<li class="@raw.severity" lang="@raw.lang">
				<h1 class="title">@HtmlFormat.raw(raw.title)</h1>
				@if(raw.description.isDefined) {
				<div class="description">@Html(raw.description.get)</div>
				}
				@if(raw.contexts.size > 0) {
				<ul class="contexts">
				@defining(raw.contexts) { contexts =>
				@contexts.map { context =>
					<li>
						@if(context.line.isDefined){<span class="line">Line: @context.line</span>}
						@if(context.column.isDefined){<span class="column">Column: @context.column</span>}
						@if(context.content != ""){<code class="context">@Html(context.content)</code>}
					</li>
				}}
				</ul>
				}
			</li>
			}}
			</ul>
		</div>
	</article>
	
	}
	
	</section>
	
}{ @***** Footer *****@

	@libs.footer()

}
