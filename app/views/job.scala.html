@(job: Job, 
    assertions: Iterable[Assertion],
    user: User,
    errors: List[(String, String)] = List.empty)(implicit flash: Flash, req: Request[_])

@import org.w3.vs.view.Helper._
@import org.w3.vs.view._

@libs.main("Validator Suite", 
	stylesheets = List("dashboard.css"),
   scripts = List("model.js", "vs.js", "report.js")){
   
   @***** Header ******@
	
	@libs.header()
	
}{ @***** Toolbar *****@

	@** <div class="report">

	<form method="get">
		<fieldset>
			<legend>Assertors</legend>
			<label><input name=assertor value=ValidatorNu type=checkbox @if(req.queryString.get("assertor").flatten.exists(_ == "ValidatorNu")){checked}>Validator.nu</label><br>
			<label><input name=assertor value=HTMLValidator type=checkbox @if(req.queryString.get("assertor").flatten.isEmpty || req.queryString.get("assertor").flatten.exists(_ == "HTMLValidator")){checked}>Markup validator</label><br>
			<label><input name=assertor value=CSSValidator type=checkbox @if(req.queryString.get("assertor").flatten.isEmpty || req.queryString.get("assertor").flatten.exists(_ == "CSSValidator")){checked}>CSS validator</label><br>
			<label><input name=assertor value=I18n-Checker type=checkbox @if(req.queryString.get("assertor").flatten.isEmpty || req.queryString.get("assertor").flatten.exists(_ == "I18n-Checker")){checked}>I18n Checker</label><br>
			<label><input name=valid type=checkbox @if(req.queryString.get("valid").flatten.exists(_ == "on")){checked}>Include valid results</label><br>
		</fieldset>
		<fieldset>
			<legend>Filters</legend>
			<!-- <label><input name=valid type=checkbox>Valid resources</label><br> -->
			<label><input name=type type=checkbox value=error @if(req.queryString.get("type").flatten.isEmpty || req.queryString.get("type").flatten.exists(_ == "error")){checked}>Errors</label><br>
			<label><input name=type type=checkbox value=warning @if(req.queryString.get("type").flatten.isEmpty || req.queryString.get("type").flatten.exists(_ == "warning")){checked}>Warnings</label><br>
			<label><input name=type type=checkbox value=info @if(req.queryString.get("type").flatten.exists(_ == "info")){checked}>Info</label><br>
		</fieldset>
		<fieldset>
			<legend>Group</legend>
			<label><input name=group type=radio value="url.assertor" @if(req.queryString.get("group").flatten.isEmpty || req.queryString.get("group").flatten.exists(_ == "url.assertor")){checked}>By url - assertor</label><br>
			<label><input name=group type=radio value="message.url" @if(req.queryString.get("group").flatten.exists(_ == "message.url")){checked}>By message - url</label><br>
			<label><input name=group type=radio value="message.context" @if(req.queryString.get("group").flatten.exists(_ == "message.context")){checked}>By message - context</label><br>
			<label><input name=flat type=checkbox @if(req.queryString.get("flat").flatten.exists(_ == "on")){checked}>Flat</label><br>
		</fieldset>
		<fieldset>
			<legend>Sort</legend>
			<label><input name=sort type=radio value=occurrences @if(req.queryString.get("sort").flatten.isEmpty || req.queryString.get("sort").flatten.exists(_ == "occurrences")){checked}>By occurrences</label><br>
			<label><input name=sort type=radio value=url @if(req.queryString.get("sort").flatten.exists(_ == "url")){checked}>By URL</label><br>
		</fieldset>
		<button>Submit</button>
	</form>
	
	<a href="?">Default</a><br>
	<a href="#" class="compact">Compact</a><br>
	
	</div> **@

}{ @***** Content *****@ 
	@libs.admin(user)
	@libs.navigation(List((job.name ,"")))
	@libs.messages(errors)
	
	<section class="job" data-id="@job.id">
		<ul>
			<li>
				<h2>Job Name</h2>
				<span class="name">@job.name</span>
			<li>
				<h2>URL</h2>
				<span class="uri">@job.strategy.entrypoint</span>
			<li>
				<h2>Distance</h2>
				<span class="distance">@job.strategy.distance</span>
			<li>
				<h2>Status</h2>
				<span class="activity">@**data.activity**@</span>
				<form action="@routes.Jobs.dispatcher(job.id)" method="post">
					@**{data.activity match {
					  case Running => {<button type="submit" name="action" value="stop" class="stop">cancel</button>}
					  case Idle => {<button type="submit" name="action" value="refresh" class="refresh">run now</button>}
					}}**@
				</form>
			<li>
				<h2>Last Run Completed</h2>
				<span class="completed">03/12/12 at 2:55pm</span>
			<li class="warningsC">
				<h2>Warnings</h2>
				<span class="warnings">data.warnings</span>
			<li class="errorsC">
				<h2>Errors</h2>
				<span class="errors">data.errors</span>
			<li class="resourcesC">
				<h2>Resources</h2>
				<span class="resources">data.resources</span>
		</ul>
	</section>
	
	<section class="controls">
		<form class="group">
			<fieldset>
				<input name=group type=radio value="url.assertor" id="url.assertor" @if(req.queryString.get("group").flatten.isEmpty || req.queryString.get("group").flatten.exists(_ == "url.assertor")){checked}>
				<label for="url.assertor">Group by url</label>
				<input name=group type=radio value="message.url" id="message.url" @if(req.queryString.get("group").flatten.exists(_ == "message.url")){checked}>
				<label for="message.url">Group by message and url</label>
				<input name=group type=radio value="message.context" id="message.context" @if(req.queryString.get("group").flatten.exists(_ == "message.context")){checked}>
				<label for="message.context">Group by message and context</label>
				@**<input name=flat id=flat type=checkbox @if(req.queryString.get("flat").flatten.exists(_ == "on")){checked}>**@
				@**<label for="flat">flat</label>**@
			</fieldset>
			<button type=submit>Go</button>
		</form>
		<form class="search">
			<input name=url type=text placeholder="Search url" required>
			<button type=submit>Go</button>
		</form>
	</section>
	
	<section id="report" class="list">
		<header>
			<div class="url">URL</div>
			<div class="last">Last Validated</div>
			<div class="warnings">Warnings</div>
			<div class="errors">Errors</div>
		</header>
	</section>
	
	<section id="report" class="nested">

	Html(generateSections(report))

	</section>
	
	@**<nav class="report"><div>
	<span class="showing">Showing: @report.size / @pageNav.totalMessages</span>
	@if(pageNav.totalPages > 1) {
	<ul>
	@for(i <- 1 to pageNav.totalPages) {
		@if(i != pageNav.currentPage) {
		<li><a href="?p=@i&@req.rawQueryString">@i</a></li>
		} else {
		<li><b>@i</b></li>
		}
	}
	</ul>
	}
	</div></nav>**@
	
}{ @***** Footer *****@

	@libs.footer()

}



















