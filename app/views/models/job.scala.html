@(job: JobView)(implicit req: Request[_])

<hr />

<article data-id="@job.id">
    <dl>
        <dt>Job Name</dt>
        <dd class="name"><a href="@routes.Jobs.show(job.id)">@job.name</a></dd>

        <dt>URL</dt>
        <dd class="url">
           <a href="@job.url" class="external" target="_blank" title="@Messages("resource.external.link")">@Helper.shorten(job.url, 100)</a>
        </dd>

        <dt>Status</dt>
        <dd class="status @job.status">
            <span>@job.status</span>
            @if(job.status == "idle"){
            <form action="@routes.Jobs.dispatcher(job.id)" method="post">
                <input type="hidden" name="uri" value="@{req.uri}">
                <button type="submit" name="action" value="run" class="run">@Messages("job.button.run")</button>
            </form>}
        </dd>

        <dt>Last Completed</dt>
        <dd class="completed">
        @job.lastCompleted match{
          case Some(date) => {
            <time datetime="@date">@Helper.formatTime(date)</time>
            <span class="legend">@Helper.formatLegendTime(date)</span>
            }
          case _ => {Never}
        }
        </dd>

        <dt>Warnings</dt>
        <dd class="warnings"><span>@job.warnings</span></dd>

        <dt>Errors</dt>
        <dd class="errors"><span>@job.errors</span></dd>

        <dt>Resources</dt>
        <dd class="resources"><span>@job.resources</span></dd>

        <dt>Max resources</dt>
        <dd class="maxResources"><span>@job.maxResources</span></dd>

        <dt>Health</dt>
        <dd class="health">
            <progress max=100 value=@job.health title="@job.health%">
                @job.health%
            </progress>
        </dd>

        <dt>Actions</dt>
        <dd class="actions">
            <form action="@routes.Jobs.dispatcher(job.id)" method="post">
                <input type="hidden" name="uri" value="@{req.uri}">
                <fieldset>
                    <legend>Job Controls</legend>
                    @defining(job.status){case status =>
                    @status match {
                        case "running" => {<button type="submit" name="action" value="stop" class="stop">@Messages("job.button.cancel")</button>}
                        case "idle"    => {<button type="submit" name="action" value="run" class="run">@Messages("job.button.run")</button>}
                    }}
                    <button type="submit" name="action" value="delete" class="delete">@Messages("job.button.delete")</button>
                </fieldset>
            </form>
            <form class="search" action="@routes.Jobs.dispatcher(job.id)" method=get>
                <fieldset>
                    <legend>Search</legend>
                    <input name=search type=text placeholder="Search" required value="@req.getQueryString("search")" @if(req.getQueryString("search") == None){class="cleared"}>
                    <!--<span>âœ˜</span>-->
                    @if(req.getQueryString("search") != None) {
                    <a class="button clear" href="@Helper.clearParam("search")">@Messages("job.button.clear")</a>}
                    @if(req.getQueryString("group") != None) {
                    <input name=group type=hidden value="@req.getQueryString("group")">}
                    @if(req.getQueryString("filter") != None) {
                    <input name=filter type=hidden value="@req.getQueryString("filter")">}
                    @if(req.getQueryString("sort") != None) {
                    <input name=sort type=hidden value="@req.getQueryString("sort")">}
                    <button type=submit>@Messages("job.button.search")</button>
                </fieldset>
                <fieldset class="dropdown">
                    <legend>Report by</legend>
                    <input name=group type=radio value="url" id="url" @if(req.queryString.get("group").flatten.isEmpty || req.queryString.get("group").flatten.exists(_ == "url")){checked}>
                    <label for="url">Group by url</label>
                    <input name=group type=radio value="message" id="message" @if(req.queryString.get("group").flatten.exists(_ == "message")){checked}>
                    <label for="message">Group by message</label>
                </fieldset>
                <button type=submit>Go</button>
            </form>
        </dd>
    </dl>
</article>